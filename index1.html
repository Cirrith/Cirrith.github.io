<!DOCTYPE html>
<html>
<head>
<script>
"use strict";
function byId(e){return document.getElementById(e);}

window.addEventListener('load', onDocLoaded, false);

function onDocLoaded()
{
    byId('mFileInput').addEventListener('change', onChosenFileChange, false);
}

function onChosenFileChange(evt)
{
    var fileType = this.files[0].type;

    if (fileType.indexOf('audio') != -1)
        loadFileObject(this.files[0], onSoundLoaded);

    else if (fileType.indexOf('image') != -1)
        loadFileObject(this.files[0], onImageLoaded);

    else if (fileType.indexOf('video') != -1)
        loadFileObject(this.files[0], onVideoLoaded);
}

function loadFileObject(fileObj, loadedCallback)
{
    var reader = new FileReader();
    reader.onload = loadedCallback;
    reader.readAsDataURL( fileObj );
}

function onSoundLoaded(evt)
{
    byId('sound').src = evt.target.result;
    byId('sound').play();
}

function onImageLoaded(evt)
{
    byId('image').src = evt.target.result;
}

function onVideoLoaded(evt)
{
    byId('video').src = evt.target.result;
    byId('video').play();
}

</script>
<style>
</style>
</head>
<body>
    <input type="file" id="mFileInput"/>
    <br>
    <audio id="sound"></audio>
    <img id='image'/>
    <video id='video'/>
</body>
</html>

<!--<body>
<audio id="player">
	<source id="sourceFile" src="" type="audio/mp3">
	Your Browser Does Not Support the Audio Element
</audio>

<button onclick="loadSong()" value="1"></button>
	
<audio id="audio" src="Nostalgia.mp3"></audio>
<input type="button" onclick="document.getElementById('fileIn').click();" value="Grab file"/>
<input type="file" onchange="start()" id="fileIn"/>
<div id="bar">
    <div id="P10" class="p"></div>
    <div id="P20" class="p"></div>
    <div id="P30" class="p"></div>
    <div id="P40" class="p"></div>
    <div id="P50" class="p"></div>
    <div id="P60" class="p"></div>
    <div id="P70" class="p"></div>
    <div id="P80" class="p"></div>
    <div id="P90" class="p"></div>
</div>

<style>
    #bar {
        position: fixed;
        top: 20%;
        left: 40%;
        width: 40%;
        height: 40%;
        -webkit-transition: 0.1s ease all;
    }

    .p {
        background-color: blue;
        height: 100%;
        width: 10%;
        float: left;
    }

</style>
<script>
	function loadSong() {
		var player=document.getElementById('player');
		var sourceMp3=document.getElementById('sourceMp3');
		sourceMp3.src='songs/' + songNo + '.mp3';

		player.load();
		player.play();
	function start() {
		document.getElementById('audio').src = document.getElementById('fileIn').value;
        audioCtx = new AudioContext();
        analyser = audioCtx.createAnalyser();
        source = audioCtx.createMediaElementSource(audio);
        source.connect(analyser);
        analyser.connect(audioCtx.destination);
        analyser.fftSize = 32;

        var frequencyData = new Uint8Array(analyser.frequencyBinCount);

        function renderFrame() {
            analyser.getByteFrequencyData(frequencyData);
            P10.style.height = ((frequencyData[0] * 100) / 256) + "%";
            P20.style.height = ((frequencyData[1] * 100) / 256) + "%";
            P30.style.height = ((frequencyData[2] * 100) / 256) + "%";
            P40.style.height = ((frequencyData[3] * 100) / 256) + "%";
            P50.style.height = ((frequencyData[4] * 100) / 256) + "%";
            P60.style.height = ((frequencyData[5] * 100) / 256) + "%";
            P70.style.height = ((frequencyData[6] * 100) / 256) + "%";
            P80.style.height = ((frequencyData[7] * 100) / 256) + "%";
            P90.style.height = ((frequencyData[8] * 100) / 256) + "%";
			console.log(document.getElementById('fileIn').value);
            console.log(frequencyData)
            requestAnimationFrame(renderFrame);
        }
        audio.pause();
        audio.play();
        renderFrame();
    };
</script>